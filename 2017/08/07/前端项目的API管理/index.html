<!DOCTYPE html><html lang="zh-Hans"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 前端项目中的RESTful API管理 · Cacivy</title><meta name="description" content="前端项目中的RESTful API管理 - Cacivy"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,600" type="text/css"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://github.com/Cacivy" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><section class="container"><div class="post"><article class="post-block"><h1 class="post-title">前端项目中的RESTful API管理</h1><div class="post-info">Aug 7, 2017</div><div class="post-content"><h2 id="RESTful-API"><a href="#RESTful-API" class="headerlink" title="RESTful API"></a>RESTful API</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">/get /users</span><br><span class="line">/getByID /users/:id</span><br><span class="line">/post /users [body]</span><br><span class="line">/put /users/:id [body]</span><br><span class="line">/patch /users/:id [body]</span><br><span class="line">/delete /users/:id</span><br></pre></td></tr></table></figure>
<p>以上是一些基本规范，但REST不是银弹，比如<code>批量处理</code>、<code>getuser</code>、<code>login</code></p>
<a id="more"></a>
<h2 id="Mock-Server"><a href="#Mock-Server" class="headerlink" title="Mock Server"></a>Mock Server</h2><p>前端独立于后端，除了约定API，还需要<code>mock server</code><br>一般使用<a href="https://github.com/typicode/json-server">json-server</a>配合<a href="https://github.com/Marak/faker.js">faker.js</a><br>接口测试则是通过<code>postman</code>，并且可以生成文档、分享等</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// index.js</span></span><br><span class="line"><span class="keyword">const</span> jsonServer = <span class="built_in">require</span>(<span class="string">'json-server'</span>)</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>)</span><br><span class="line"><span class="keyword">const</span> server = jsonServer.create()</span><br><span class="line"><span class="keyword">const</span> data = <span class="built_in">require</span>(<span class="string">'./data'</span>)</span><br><span class="line"><span class="comment">//path.join(__dirname, 'db.json')</span></span><br><span class="line"><span class="keyword">const</span> router = jsonServer.router(data())</span><br><span class="line"><span class="keyword">const</span> middlewares = jsonServer.defaults()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">resData</span>(<span class="params">data=&#123;&#125;, code=<span class="number">200</span>, msg=<span class="string">''</span></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    code,</span><br><span class="line">    data,</span><br><span class="line">    msg</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Custom output</span></span><br><span class="line">router.render = <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.jsonp(resData(res.locals.data, res.statusCode))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Set default middlewares (logger, static, cors and no-cache)</span></span><br><span class="line">server.use(middlewares)</span><br><span class="line"></span><br><span class="line"><span class="comment">// To handle POST, PUT and PATCH you need to use a body-parser</span></span><br><span class="line"><span class="comment">// You can use the one used by JSON Server</span></span><br><span class="line">server.use(jsonServer.bodyParser)</span><br><span class="line">server.use(<span class="function">(<span class="params">req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// if (req.method === 'POST') &#123;</span></span><br><span class="line">  <span class="comment">//   req.body.createdAt = Date.now()</span></span><br><span class="line">  <span class="comment">// &#125;</span></span><br><span class="line">  next()</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> session</span><br><span class="line"></span><br><span class="line">server.get(<span class="string">'/api/user'</span>, (req, res) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (session) &#123;</span><br><span class="line">    res.jsonp(resData(session, <span class="number">200</span>))</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    res.jsonp(resData(<span class="literal">undefined</span>, <span class="number">403</span>, <span class="string">'未登录'</span>))</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">server.post(<span class="string">'/api/login'</span>, (req, res) =&gt; &#123;</span><br><span class="line">  <span class="keyword">let</span> body = req.body, code = <span class="number">302</span>, data = &#123;&#125;, msg = <span class="string">'密码错误'</span></span><br><span class="line">  <span class="keyword">if</span> (body.username === <span class="string">'admin'</span> &amp;&amp; body.password === <span class="string">'admin'</span>) &#123;</span><br><span class="line">    msg = <span class="string">''</span></span><br><span class="line">    code = <span class="number">200</span></span><br><span class="line">    data = req.body</span><br><span class="line">    data.id = <span class="number">1</span></span><br><span class="line">    <span class="keyword">delete</span> data.password</span><br><span class="line">    session = data</span><br><span class="line">  &#125;</span><br><span class="line">  res.jsonp(resData(data, code, msg))</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">server.get(<span class="string">'/api/logout'</span>, (req, res) =&gt; &#123;</span><br><span class="line">  session = <span class="literal">null</span></span><br><span class="line">  res.jsonp(resData(&#123;&#125;, <span class="number">200</span>, <span class="string">'注销成功'</span>))</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Use default router</span></span><br><span class="line">server.use(<span class="string">'/api'</span>, router)</span><br><span class="line"><span class="keyword">const</span> port = <span class="number">9999</span></span><br><span class="line">server.listen(port, () =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'JSON Server is running, port: '</span>+ port)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// data.js</span></span><br><span class="line"><span class="keyword">const</span> faker = <span class="built_in">require</span>(<span class="string">'faker'</span>)</span><br><span class="line">faker.locale = <span class="string">'zh_CN'</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> data = &#123;</span><br><span class="line">    users: [],</span><br><span class="line">    roles: [],</span><br><span class="line">    departments: []</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// Create 100users</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i++) &#123;</span><br><span class="line">    data.users.push(&#123;</span><br><span class="line">      id: i,</span><br><span class="line">      username: faker.name.findName(),</span><br><span class="line">      nikename: faker.name.findName(),</span><br><span class="line">      freezeState: faker.random.boolean(),</span><br><span class="line">      freezeInfo: faker.lorem.sentence()</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">28</span>; i++) &#123;</span><br><span class="line">    data.roles.push(&#123;</span><br><span class="line">      id: i,</span><br><span class="line">      no: faker.name.jobType(),</span><br><span class="line">      name: faker.name.jobType(),</span><br><span class="line">      type: faker.name.jobType()</span><br><span class="line">    &#125;)</span><br><span class="line">    data.departments.push(&#123;</span><br><span class="line">      id: i,</span><br><span class="line">      name: faker.commerce.department(),</span><br><span class="line">      description: faker.commerce.productAdjective()</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> data</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="API-Manage"><a href="#API-Manage" class="headerlink" title="API Manage"></a>API Manage</h2><p>这里使用axios作为http请求库</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// index.js</span></span><br><span class="line"><span class="keyword">import</span> instance <span class="keyword">from</span> <span class="string">'./instance'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> apiConfig = &#123;</span><br><span class="line">  login: [<span class="string">'get'</span>, <span class="string">'post'</span>],</span><br><span class="line">  logout: [<span class="string">'get'</span>],</span><br><span class="line">  user: [<span class="string">'get'</span>],</span><br><span class="line">  users: [],</span><br><span class="line">  roles: [],</span><br><span class="line">  departments: []</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> API = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> defaultMethods = [<span class="string">'get'</span>, <span class="string">'post'</span>, <span class="string">'put'</span>, <span class="string">'patch'</span>, <span class="string">'delete'</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> getMethod = <span class="function">(<span class="params">key, method</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">switch</span> (method) &#123;</span><br><span class="line">  <span class="keyword">case</span> <span class="string">'get'</span>:</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function">(<span class="params">params</span>) =&gt;</span> instance.get(key, &#123;</span><br><span class="line">      params</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">case</span> <span class="string">'getById'</span>:</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function">(<span class="params">id, params</span>) =&gt;</span> instance.get(<span class="string">`<span class="subst">$&#123;key&#125;</span>/<span class="subst">$&#123;id&#125;</span>`</span>, &#123;params&#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">case</span> <span class="string">'post'</span>:</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function">(<span class="params">body</span>) =&gt;</span> instance.post(key, body)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">case</span> <span class="string">'put'</span>:</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function">(<span class="params">id, body</span>) =&gt;</span> instance.put(<span class="string">`<span class="subst">$&#123;key&#125;</span>/<span class="subst">$&#123;id&#125;</span>`</span>, body)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">case</span> <span class="string">'patch'</span>:</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function">(<span class="params">id, body</span>) =&gt;</span> instance.patch(<span class="string">`<span class="subst">$&#123;key&#125;</span>/<span class="subst">$&#123;id&#125;</span>`</span>, body)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">case</span> <span class="string">'delete'</span>:</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function">(<span class="params">id</span>) =&gt;</span> instance.delete(<span class="string">`<span class="subst">$&#123;key&#125;</span>/<span class="subst">$&#123;id&#125;</span>`</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">default</span>:</span><br><span class="line">    <span class="keyword">break</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">of</span> <span class="built_in">Object</span>.keys(apiConfig)) &#123;</span><br><span class="line">  <span class="keyword">let</span> list = apiConfig[key].length ? apiConfig[key] : defaultMethods</span><br><span class="line">  list.forEach(<span class="function"><span class="params">method</span> =&gt;</span> &#123;</span><br><span class="line">    API[key] = API[key] || &#123;&#125;</span><br><span class="line">    API[key][method] = getMethod(key, method)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> API</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// instance.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; httpConfig <span class="keyword">as</span> host &#125; <span class="keyword">from</span> <span class="string">'config'</span></span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">'axios'</span></span><br><span class="line"><span class="keyword">import</span> &#123; message &#125; <span class="keyword">from</span> <span class="string">'antd'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> instance = axios.create(&#123;</span><br><span class="line">  baseURL: host,</span><br><span class="line">  timeout: <span class="number">10000</span>,</span><br><span class="line">  withCredentials: <span class="literal">true</span>,</span><br><span class="line">  headers: &#123;&#125;,</span><br><span class="line">  validateStatus (status) &#123;</span><br><span class="line">    <span class="keyword">return</span> status &gt;= <span class="number">200</span> &amp;&amp; status &lt;= <span class="number">500</span> <span class="comment">// default</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 全局request钩子</span></span><br><span class="line">axios.interceptors.request.use(<span class="function"><span class="keyword">function</span> (<span class="params">config</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> config</span><br><span class="line">&#125;, <span class="function"><span class="keyword">function</span> (<span class="params">error</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(error)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 全局response钩子</span></span><br><span class="line">instance.interceptors.response.use(<span class="function"><span class="keyword">function</span> (<span class="params">response</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 请求失败</span></span><br><span class="line">  <span class="keyword">if</span> (response.status.toString().substr(<span class="number">0</span>, <span class="number">1</span>) !== <span class="string">'2'</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(response.data)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// code 302 登录失败</span></span><br><span class="line">  <span class="keyword">if</span> (response.data.code === <span class="number">302</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(response.data)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// code 403 无权限</span></span><br><span class="line">  <span class="keyword">if</span> (response.data.code === <span class="number">403</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(response.data)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 其它错误</span></span><br><span class="line">  <span class="keyword">if</span> (response.data.code.toString().substr(<span class="number">0</span>, <span class="number">1</span>) !== <span class="string">'2'</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(response.data)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">let</span> count = response.headers[<span class="string">'x-total-count'</span>]</span><br><span class="line">  <span class="keyword">if</span> (count !== <span class="literal">undefined</span>) &#123;</span><br><span class="line">    response.data.count = count</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> response.data</span><br><span class="line">&#125;, (error) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (error.message.indexOf(<span class="string">'timeout'</span>) &gt; <span class="number">-1</span>) &#123;</span><br><span class="line">    message.error(<span class="string">'请求超时！'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(error)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> instance</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// use</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> res = <span class="keyword">await</span> API.login.post()</span><br><span class="line"></span><br><span class="line">  <span class="built_in">console</span>.log(res)</span><br><span class="line"></span><br><span class="line">&#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">console</span>.log(error)</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// or</span></span><br><span class="line"></span><br><span class="line">API.login.post().then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">console</span>.log(res)</span><br><span class="line"></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>以上就实现了api统一管理，并通过API对象下不同接口子对象进行调用</p>
</div></article></div></section><footer><div class="paginator"><a href="/2017/08/09/使用Eslint-Standard管理前端代码风格/" class="prev">PREV</a><a href="/2017/07/25/webpack优化指南/" class="next">NEXT</a></div><div id="disqus_thread"></div><script>var disqus_shortname = 'http-blog-cacivy-com';
var disqus_identifier = '2017/08/07/前端项目的API管理/';
var disqus_title = '前端项目中的RESTful API管理';
var disqus_url = 'https://github.com/Cacivy/2017/08/07/前端项目的API管理/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//http-blog-cacivy-com.disqus.com/count.js" async></script><div class="copyright"><p>© 2016 - 2019 <a href="https://github.com/Cacivy">Cacivy</a> | Power By Hexo.</p><p id="busuanzi_container_site_uv">view <span id="busuanzi_value_site_uv"></span> times</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-MML-AM_CHTML"></script><script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-85349261-2",'auto');ga('send','pageview');</script></body></html>